# Load Turkish Keys
  loadkeys trq
  
# Select Editor
  export EDITOR=nano

# Connect Internet
  wifi-menu

# Partitioning the Hard Drive
  # parted /dev/sda 
      (parted) mklabel gpt
      (parted) mkpart ESP fat32 1MiB 513MiB
      (parted) set 1 boot on
      (parted) name 1 efi
      (parted) mkpart primary 513MiB 1026MiB
      (parted) name 2 boot
      (parted) mkpart primary 1026MiB 100%
      (parted) name 3 lvm-partition
      (parted) print
      (parted) quit
  
  parted /dev/sda set 3 lvm on
  parted /dev/sda print
  
  pvcreate /dev/sda3

  vgcreate  arch-lvm /dev/sda3

  lvcreate -n arch-root -L 20G arch-lvm
  lvcreate -n arch-swap -L 2G arch-lvm
  lvcreate -n arch-home -l 100%FREE arch-lvm
  
  mkfs.fat -F32 /dev/sda1
  mkfs.ext2 /dev/sda2
  mkfs.btrfs -L root /dev/arch-lvm/arch-root
  mkfs.btrfs -L home /dev/arch-lvm/arch-home
  mkswap /dev/arch-lvm/arch-swap
  swapon /dev/arch-lvm/arch-swap
  
  mount /dev/arch-lvm/arch-root /mnt
  mkdir /mnt/home
  mkdir /mnt/home
  mount /dev/sda2 /mnt/boot
  mkdir /mnt/boot/efi
  mount /dev/sda1 /mnt/boot/efi
  mount /dev/arch-lvm/arch-home /mnt/home

# Installing basic software packages
  pacstrap /mnt base base-devel grub btrfs-progs efibootmgr dialog wpa_supplicant avahi nss-mdns acpid acpi cups xorg xorg-drivers mesa pulseaudio
  
  genfstab -U -p /mnt > /mnt/etc/fstab
  nano /mnt/etc/fstab

  Change relatime to noatime on the root partition to reduce SSD wear.

  Add tmpfs /tmp tmpfs rw,noatime,nodev,nosuid 0 0 if you want to keep /tmp in RAM.

# Chroot
  arch-chroot /mnt /bin/bash
  
# Setting the System Clock
  timedatectl set-timezone Europe/Istanbul
  timedatectl set-ntp true
  hwclock --systohc
  
# Locale
  nano /etc/locale.gen
  -- en_US.UTF-8 UTF-8
  -- en_US ISO-8859-1
  locale-gen
  
# Hostname
  hostnamectl set-hostname archlinux

# HOOKS
  Edit /etc/mkinitcpio.conf to add lvm2 to HOOKS before filesystems. 
  Also add resume after filesystems to support resuming from hibernation.
  
  HOOKS=(base udev autodetect modconf block lvm2 filesystems resume keyboard fsck)
  
  mkinitcpio -p linux
  
# Root Password
  passwd
  
# Grub
  nano /etc/default/grub
  GRUB_ENABLE_CRYPTODISK=y
  GRUB_CMDLINE_LINUX="cryptdevice=/dev/sda2:luks:allow-discards resume=/dev/vg0/swap"
  
  grub-install --efi-directory=/boot
  grub-mkconfig -o /boot/grub/grub.cfg
  
  exit
  
  umount -R /mnt
  swapoff -a
  reboot
  
# Login
  localectl set-keymap --no-convert trq
  localectl set-x11-keymap tr
  
#Activate Units
  systemctl enable acpid.service
  systemctl enable fstrim.timer
  systemctl enable org.cups.cupsd.service
  systemctl enable avahi-daemon.service
  
# Local Hostname Resolution
 
  nano /etc/hosts

  127.0.0.1        localhost
  ::1              localhost
  127.0.1.1        archlinux.localdomain        archlinux
  
# Add User
  useradd -m ceyhan
  passwd ceyhan 
  
# General Recommendations
  pacman -S firefox gimp inkscape blender faenza-icon-theme ttf-droid ttf-font-awesome ttf-anonymous-pro ttf-linux-libertine ttf-liberation gtk-engines elementary-icon-theme materia-gtk-theme arc-gtk-theme arc-icon-theme gtk-engine-murrine openssh curl wget 

# AMDGPU
  pacman -S xf86-video-amdgpu
